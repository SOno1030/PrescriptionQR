# DummyPrescriptionMaker
# 処方箋入力トレーニング用Webアプリケーション 要件定義書

### 1. 概要

#### 1.1. アプリケーションの目的
本アプリケーションは、新人薬剤師がレセコン（レセプトコンピュータ）への処方箋入力業務に習熟することを目的としたトレーニングツールである。実際の処方箋に近い形式のダミー処方箋をWebブラウザ上に表示し、様々なパターンの処方箋に触れる機会を提供する。

#### 1.2. コンセプト
* **リアリズムの追求**: 実際の業務で遭遇する多種多様な処方箋を再現するため、医薬品情報、保険情報（社保・国保・公費など）の概念を詳細に盛り込む。
* **繰り返しトレーニング**: ボタン一つで新しい処方箋を何度でも生成でき、反復練習を可能にする。
* **プライバシーへの配慮**: 生成される患者名はダミーであるが、実在する可能性を考慮し、ユーザーが任意の名前に変更できる機能を提供する。

#### 1.3. 想定利用環境
* **プラットフォーム**: Webブラウザ
* **サーバーサイド技術**: Python (Flaskフレームワーク)
* **データベース**: SQLite (アプリケーションに内包し、手軽に利用できることを想定)

---

### 2. 機能要件

#### 2.1. ダミー処方箋生成機能
アプリケーションのコア機能。以下の要素をランダムに組み合わせて、1枚の処方箋データを生成する。

| 要素 | 詳細 | 生成ロジック・要件 |
| :--- | :--- | :--- |
| **患者情報** | 氏名、性別、生年月日 | ・**氏名**: 姓・名データベース（後述）からランダムに組み合わせて生成。<br>・**性別**: 男性・女性をランダムに選択。<br>・**生年月日**: 現実的な年齢（例: 0歳～90歳）になるようランダムに生成。 |
| **保険情報** | 保険種別、記号・番号、公費情報 | ・**保険種別**: 「協会けんぽ」「組合健保」「国民健康保険」「後期高齢者医療制度」など、マスタからランダムに選択。<br>・**記号・番号**: 各保険種別に準じた、それらしい形式・桁数の文字列をランダムに生成。<br>・**公費**: 「乳幼児医療」「ひとり親家庭等医療」などを確率的に付与。患者の年齢と連動させる（例: 5歳児には乳幼児医療を付与）。 |
| **医療機関情報** | 医療機関名、医師名、所在地 | ・ダミーの医療機関名（例: 「〇〇内科クリニック」）、医師名をランダムに生成。 |
| **処方箋情報** | 発行日、処方内容 (Rp.) | ・**発行日**: アプリケーション利用日、または過去の日付をランダムに設定。<br>・**処方内容**: 複数の薬剤ブロック (Rp.1, Rp.2...) を生成可能（1～5個程度）。 |
| **医薬品情報** | 医薬品名、用法・用量、剤形、日数 | ・**医薬品名**: 医薬品マスタ（後述）からランダムに選択。内服薬・外用薬・頓服薬が混在するようにする。<br>・**用法・用量**: 「1回1錠 1日3回 朝昼夕食後」「1日1回 就寝前」のような定型的な用法マスタからランダムに選択。<br>・**日数**: 「7日分」「14日分」「28日分」など、一般的な処方日数をランダムに選択。 |

#### 2.2. 処方箋表示機能
* 生成したダミー処方箋データを、実際の処方箋レイアウトに近い形式でHTMLページに表示する。
* 表示項目は、日本の保険処方箋の様式に準拠すること（患者情報、保険情報、医療機関情報、処方内容、医師名、発行日、保険医登録番号など）。
* 処方内容は、Rp.ごとにブロックを分けて表示する。

#### 2.3. 患者名編集機能
* 表示された処方箋の患者名が実在しそうだとユーザーが判断した場合に、その場で名前を編集できるようにする。
* 患者氏名の表示部分にテキスト入力フィールドを設け、ユーザーが自由な文字列を入力できるようにする。
* 入力後にフォーカスが外れるか、専用の「更新」ボタンを押すことで、表示されている処方箋の氏名が入力内容に即時反映されること（ページリロードは不要）。

#### 2.4. 処方箋再生成機能
* 画面上に「新しい処方箋を生成」ボタンを常時表示する。
* このボタンをクリックすると、2.1のロジックが再度実行され、全く新しい内容の処方箋が生成・表示される。

---

### 3. データ要件（データベース設計）

アプリケーションのリアリティを担保するため、以下のマスタデータをSQLiteデータベースで保持する。

#### 3.1. 医薬品マスタ (`medicines`)
内服薬、外用薬、頓服薬を合わせて数百種類程度登録する。

| カラム名 | データ型 | 説明 | 例 |
| :--- | :--- | :--- | :--- |
| `id` | INTEGER | 主キー | 1 |
| `name` | TEXT | 医薬品名（商品名＋規格） | `アムロジピンOD錠5mg「DSEP」` |
| `type` | TEXT | 薬剤種別（内服, 外用, 頓服） | `内服` |
| `unit` | TEXT | 単位 | `錠` |

#### 3.2. 用法マスタ (`usages`)
様々な用法パターンを登録する。

| カラム名 | データ型 | 説明 | 例 |
| :--- | :--- | :--- | :--- |
| `id` | INTEGER | 主キー | 1 |
| `usage_text` | TEXT | 用法のテキスト | `1日3回毎食後` |
| `type` | TEXT | 薬剤種別（内服, 外用, 頓服） | `内服` |

#### 3.3. 姓名マスタ
一般的な日本の姓名を登録する。

* **姓マスタ (`surnames`)**
    * `id` (INTEGER, 主キー), `name` (TEXT) - 例: `佐藤`, `鈴木`
* **名マスタ (`given_names`)**
    * `id` (INTEGER, 主キー), `name` (TEXT), `gender` (TEXT) - 例: `太郎` (男性), `花子` (女性)

---

### 4. 画面構成案（ワイヤーフレーム）
